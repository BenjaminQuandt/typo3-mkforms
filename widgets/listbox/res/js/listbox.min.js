Formidable.Classes.ListBox=Formidable.Classes.RdtBaseClass.extend({replaceData:function(a){this.clearData();for(var b in a){var c=new Option(a[b],b);this.domNode().options[this.domNode().options.length]=c;if(a[b]!=null){this.domNode().options[(this.domNode().options.length-1)].innerHTML=a[b]}else{this.domNode().options[(this.domNode().options.length-1)].innerHTML=""}}},getData:function(c){var d=this.domNode().options;var e={};MKWrapper.each(MKWrapper.$A(d),function(a,b){if(!c){e[a.value]=a.innerHTML}else{e[b]=a.value}},this);return e},setSelected:function(a){if(this.domNode()){this.domNode().value=a}},setAllSelected:function(){if(this.domNode()){$A(this.domNode().options).each(function(a,b){this.domNode().options[b].selected=true}.bind(this))}},setNoneSelected:function(){if(this.domNode()){var c=this;MKWrapper.each(c.domNode().options,function(a,b){c.domNode().options[b].selected=false},c)}this.domNode().selectedIndex=this.domNode().multiple?-1:0},clearData:function(a){this.clearValue();this.domNode().options.length=0},clearValue:function(a){this.setNoneSelected()},rebirth:function(a){this.domNode().value=a},getCaptionForValue:function(c){var d=this.domNode().options;var e=false;$A(d).each(function(a,b){if(a.value==c){e=a.text}}.bind(this));return e},addItem:function(a){this.domNode().options[this.domNode().options.length]=new Option(a["caption"],a["value"])},removeItem:function(c){MKWrapper.each(MKWrapper.$A(this.domNode().options),function(a,b){if(a.value==c["value"]){this.domNode().options[b]=null}}.bind(this))},removeSelectedItems:function(){oDomNode=this.domNode();for(var i=oDomNode.options.length-1;i>=0;i--){if(oDomNode.options[i].selected)oDomNode.options[i]=null}},modifyItem:function(c){$A(this.domNode().options).each(function(a,b){if(this.domNode().options[b].value==c["value"]){this.domNode().options[b].text=c["caption"]}}.bind(this))},transferSelectedTo:function(b){if((oOtherList=this.oForm.o(b["list"]))){aValues=this.getValue();$A(aValues).each(function(a){oOtherList.domNode().options[oOtherList.domNode().options.length]=new Option(this.getCaptionForValue(a),a);if(b["removeFromSource"]==true){this.removeItem({"value":a})}}.bind(this))}},moveSelectedTop:function(){oDomNode=this.domNode();var a=oDomNode.selectedIndex;if(a>0){oSelected=oDomNode.options[a];oNewOption=new Hash();oNewOption.set(oSelected.value,oSelected.innerHTML);oNewData=oNewOption.merge($H(this.getData())).toObject();this.replaceData(oNewData);oDomNode.selectedIndex=0}},moveSelectedUp:function(){oDomNode=this.domNode();var a=oDomNode.selectedIndex;if(a>0){oSelected=oDomNode.options[a];oTarget=oDomNode.options[a-1];oNewTarget=new Option(oSelected.innerHTML,oSelected.value);oNewSelected=new Option(oTarget.innerHTML,oTarget.value);oDomNode.options[a-1]=oNewTarget;oDomNode.options[a]=oNewSelected;oDomNode.selectedIndex=(a-1)}},moveSelectedDown:function(){oDomNode=this.domNode();var a=oDomNode.selectedIndex;if(a>=0&&a<(oDomNode.options.length-1)){oSelected=oDomNode.options[a];oTarget=oDomNode.options[a+1];oNewTarget=new Option(oSelected.innerHTML,oSelected.value);oNewSelected=new Option(oTarget.innerHTML,oTarget.value);oDomNode.options[a+1]=oNewTarget;oDomNode.options[a]=oNewSelected;oDomNode.selectedIndex=(a+1)}},moveSelectedBottom:function(){oDomNode=this.domNode();var a=oDomNode.selectedIndex;if(a>=0&&a<(oDomNode.options.length-1)){oSelected=oDomNode.options[a];oNewOption=new Hash();oNewOption.set(oSelected.value,oSelected.innerHTML);oNewData=$H(this.getData());oNewData.unset(oSelected.value);oNewData=oNewData.merge(oNewOption).toObject();this.replaceData(oNewData);oDomNode.selectedIndex=(oDomNode.options.length-1)}},disableItem:function(c){$A(this.domNode().options).each(function(a,b){if(this.domNode().options[b].value==c){this.domNode().options[b].disabled='disabled'}}.bind(this))},enableAll:function(c){$A(this.domNode().options).each(function(a,b){this.domNode().options[b].disabled=''}.bind(this))}});